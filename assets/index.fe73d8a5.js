var m=(t,o,n)=>new Promise((a,r)=>{var l=e=>{try{u(n.next(e))}catch(i){r(i)}},s=e=>{try{u(n.throw(e))}catch(i){r(i)}},u=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,s);u((n=n.apply(t,o)).next())});import{v as d,k as c,at as _,a as v,C as $,f as B,L as z,au as C,av as I,aw as p,o as g,j as b,z as f,B as h,t as F,ax as w,c as k,b as A,ay as N,az as T,n as D,aA as j,aB as O,aC as P,aD as y}from"./index.e3f30c55.js";import{u as L}from"./useFormItem.cf111819.js";function R(t){const o=d(t),n=d(!1);let a;function r(){a&&window.clearInterval(a)}function l(){n.value=!1,r(),a=null}function s(){c(n)||!!a||(n.value=!0,a=setInterval(()=>{c(o)===1?(l(),o.value=t):o.value-=1},1e3))}function u(){o.value=t,l()}function e(){u(),s()}return _(()=>{u()}),{start:s,reset:u,restart:e,clear:r,stop:l,currentCount:o,isStart:n}}const V={value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},E=v({name:"CountButton",components:{Button:$},props:V,setup(t){const o=d(!1),{currentCount:n,isStart:a,start:r,reset:l}=R(t.count),{t:s}=k(),u=B(()=>c(a)?s("component.countdown.sendText",[c(n)]):s("component.countdown.normalText"));z(()=>{t.value===void 0&&l()});function e(){return m(this,null,function*(){const{beforeStartFunc:i}=t;if(i&&I(i)){o.value=!0;try{(yield i())&&r()}finally{o.value=!1}}else r()})}return{handleStart:e,currentCount:n,loading:o,getButtonText:u,isStart:a}}});function U(t,o,n,a,r,l){const s=p("Button");return g(),b(s,w(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:f(()=>[h(F(t.getButtonText),1)]),_:1},16,["disabled","onClick","loading"])}var S=C(E,[["render",U]]);const q={value:{type:String},size:{type:String,validator:t=>["default","large","small"].includes(t)},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},x=v({name:"CountDownInput",components:{CountButton:S},inheritAttrs:!1,props:q,setup(t){const{prefixCls:o}=A("countdown-input"),[n]=L(t);return{prefixCls:o,state:n}}});function G(t,o,n,a,r,l){const s=p("CountButton"),u=p("a-input");return g(),b(u,w(t.$attrs,{class:t.prefixCls,size:t.size,value:t.state}),N({addonAfter:f(()=>[D(s,{size:t.size,count:t.count,value:t.state,beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])]),_:2},[T(Object.keys(t.$slots).filter(e=>e!=="addonAfter"),e=>({name:e,fn:f(i=>[j(t.$slots,e,O(P(i||{})))])}))]),1040,["class","size","value"])}var H=C(x,[["render",G]]);const W=y(H);y(S);export{W as C};
